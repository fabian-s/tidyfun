<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Converting data to tf • tidyfun</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Converting data to tf">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyfun</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/x01_tf_Vectors.html">tf Vectors and Operations</a>
    </li>
    <li>
      <a href="../articles/x02_Conversion.html">Converting data to tf</a>
    </li>
    <li>
      <a href="../articles/x03_Data_Wrangling.html">Data Wrangling</a>
    </li>
    <li>
      <a href="../articles/x04_Visualization.html">Visualization</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fabian-s/tidyfun">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Converting data to tf</h1>
                        <h4 class="author">Jeff Goldsmith</h4>
            
            <h4 class="date">2019-05-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fabian-s/tidyfun/blob/master/vignettes/x02_Conversion.Rmd"><code>vignettes/x02_Conversion.Rmd</code></a></small>
      <div class="hidden name"><code>x02_Conversion.Rmd</code></div>

    </div>

    
    
<p>Functional data have often been stored in matrices or data frames. Although these structures have sufficed for some purposes, they are cumbersome or impossible to use with modern tools for data wrangling.</p>
<p>In this vignette, we illustrate how to convert data from common structures to <code>tf</code> objects. Throughout, functional data vectors are stored as columns in a data frame to facilitate subsequent wrangling and analysis.</p>
<div id="conversion-from-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-from-matrices" class="anchor"></a>Conversion from matrices</h2>
<p>in these, we’ll use <code>tfd</code> to get a <code>tf</code> object from a matrix. This function expects data to be organized so that each row is the functional observation for a single subject.</p>
<p>DTI (from the <code>refund</code> package), with spaghetti plot (this code is used to create the <code><a href="../reference/dti_df.html">tidyfun::dti_df</a></code> dataset included in the package. )</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">dti_df =<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="dt">id =</span> refund<span class="op">::</span>DTI<span class="op">$</span>ID, </a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="dt">sex =</span> refund<span class="op">::</span>DTI<span class="op">$</span>sex, </a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="dt">case =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(refund<span class="op">::</span>DTI<span class="op">$</span>case, <span class="st">"MS"</span>, <span class="st">"control"</span>)))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">dti_df<span class="op">$</span>cca =<span class="st"> </span><span class="kw"><a href="../reference/tfd.html">tfd</a></span>(refund<span class="op">::</span>DTI<span class="op">$</span>cca, <span class="dt">arg =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">l =</span> <span class="dv">93</span>))</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">dti_df<span class="op">$</span>rcst =<span class="st"> </span><span class="kw"><a href="../reference/tfd.html">tfd</a></span>(refund<span class="op">::</span>DTI<span class="op">$</span>rcst, <span class="dt">arg =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">l =</span> <span class="dv">55</span>))</a></code></pre></div>
<p>Make a quick plot</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">dti_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/ggspaghetti.html">geom_spaghetti</a></span>(<span class="kw">aes</span>(<span class="dt">y =</span> cca, <span class="dt">col =</span> case, <span class="dt">alpha =</span> <span class="fl">.2</span> <span class="op">+</span><span class="st"> </span><span class="fl">.4</span><span class="op">*</span>(case <span class="op">==</span><span class="st"> "control"</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>sex) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_alpha</span>(<span class="dt">guide =</span> <span class="st">'none'</span>, <span class="dt">range =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(.<span class="dv">2</span>, <span class="fl">.4</span>))</a></code></pre></div>
<p><img src="x02_Conversion_files/figure-html/unnamed-chunk-2-1.png" width="90%"></p>
<p>Canadian weather (from the <code>fda</code> package):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">canada =<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="dt">place =</span> fda<span class="op">::</span>CanadianWeather<span class="op">$</span>place, </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">region =</span> fda<span class="op">::</span>CanadianWeather<span class="op">$</span>region, </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">lat =</span> fda<span class="op">::</span>CanadianWeather<span class="op">$</span>coordinates[,<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">lon =</span> <span class="op">-</span>fda<span class="op">::</span>CanadianWeather<span class="op">$</span>coordinates[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">canada<span class="op">$</span>temp =<span class="st"> </span><span class="kw"><a href="../reference/tfd.html">tfd</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(fda<span class="op">::</span>CanadianWeather<span class="op">$</span>dailyAv[,,<span class="dv">1</span>]), <span class="dt">arg =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">365</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">canada<span class="op">$</span>precipl10 =<span class="st"> </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/tfd.html">tfd</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(fda<span class="op">::</span>CanadianWeather<span class="op">$</span>dailyAv[,,<span class="dv">3</span>]), <span class="dt">arg =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">365</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span>tf_smooth</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">## using f = 0.15 as smoother span for lowess</span></a></code></pre></div>
<p>spaghetti – two panels with patchwork to put them together</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">temp_panel =</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span>canada <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> temp, <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/ggspaghetti.html">geom_spaghetti</a></span>() </a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">precip_panel =</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span>canada <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> precipl10, <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/ggspaghetti.html">geom_spaghetti</a></span>() </a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">gridExtra<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(temp_panel, precip_panel, <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="x02_Conversion_files/figure-html/unnamed-chunk-4-1.png" width="90%"></p>
</div>
<div id="from-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#from-data-frame" class="anchor"></a>From data frame</h2>
<div id="in-long-format" class="section level3">
<h3 class="hasAnchor">
<a href="#in-long-format" class="anchor"></a>… in “long” format</h3>
<p>throughout, <code>tf_nest</code> is the key function.</p>
<p>Pig weight, from package <code>SemiPar</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"pig.weights"</span>, <span class="dt">package =</span> <span class="st">"SemiPar"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">pig.weights =<span class="st"> </span><span class="kw">as_tibble</span>(pig.weights)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">pig.weights</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## # A tibble: 432 x 3</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">##    id.num num.weeks weight</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">##     &lt;int&gt;     &lt;int&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">##  1      1         1   24  </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">##  2      1         2   32  </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">##  3      1         3   39  </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">##  4      1         4   42.5</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">##  5      1         5   48  </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">##  6      1         6   54.5</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">##  7      1         7   61  </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">##  8      1         8   65  </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">##  9      1         9   72  </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">## 10      2         1   22.5</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">## # … with 422 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">pig_df =<span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span>pig.weights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/tf_nest.html">tf_nest</a></span>(weight, <span class="dt">.id =</span> id.num, <span class="dt">.arg =</span> num.weeks)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">pig_df</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">## # A tibble: 48 x 2</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">##    id.num weight                       </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">##     &lt;int&gt; &lt;tfd_reg&gt;                    </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">##  1      1 1: (1,24);(2,32);(3,39); ... </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">##  2      2 2: (1,22);(2,30);(3,40); ... </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">##  3      3 3: (1,22);(2,28);(3,36); ... </span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">##  4      4 4: (1,24);(2,32);(3,40); ... </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">##  5      5 5: (1,24);(2,32);(3,37); ... </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">##  6      6 6: (1,23);(2,30);(3,36); ... </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">##  7      7 7: (1,22);(2,28);(3,36); ... </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">##  8      8 8: (1,24);(2,30);(3,38); ... </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">##  9      9 9: (1,20);(2,28);(3,33); ... </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">## 10     10 10: (1,26);(2,32);(3,40); ...</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">## # … with 38 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">pig_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/ggspaghetti.html">geom_spaghetti</a></span>()</a></code></pre></div>
<p><img src="x02_Conversion_files/figure-html/unnamed-chunk-7-1.png" width="90%"></p>
<p>FEV from <code>ALA</code> package (installation is from non-cran):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"ALA"</span>, <span class="dt">repos=</span><span class="st">"http://R-Forge.R-project.org"</span>)</a></code></pre></div>
<p>useful because you can nest multiple functions, if they exist in the dataset</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">ALA<span class="op">::</span>fev1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_obs =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(n_obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/tf_nest.html">tf_nest</a></span>(logFEV1, height, <span class="dt">.arg =</span> age)</a></code></pre></div>
</div>
<div id="in-wide-format" class="section level3">
<h3 class="hasAnchor">
<a href="#in-wide-format" class="anchor"></a>… in “wide” format</h3>
<p>Doesn’t happen too often, but sometimes you get data in “wide” format. Here we convert DTI data to look like this, then use <code>tf_gather</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">dti =<span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span>refund<span class="op">::</span>DTI <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span>janitor<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/janitor/topics/clean_names">clean_names</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">starts_with</span>(<span class="st">"rcst"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="../reference/tf_gather.html">tf_gather</a></span>(<span class="kw">starts_with</span>(<span class="st">"cca"</span>))</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">## creating new tfd-column &lt;cca&gt;</span></a></code></pre></div>
</div>
</div>
<div id="other-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#other-formats" class="anchor"></a>Other formats</h2>
<p><code>fda</code> and <code>fd</code> coming soon …</p>
</div>
<div id="back-to-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#back-to-matrices" class="anchor"></a>Back to matrices</h2>
<p>THINGS BREAK BELOW HERE</p>
<div id="wrangling-tf-objects-inside-data-frames-tidyr" class="section level3">
<h3 class="hasAnchor">
<a href="#wrangling-tf-objects-inside-data-frames-tidyr" class="anchor"></a>wrangling <code>tf</code>-objects inside data frames: <code>tidyr</code>
</h3>
<p><strong><code>tidyfun</code></strong> provides <code>tf_</code> variants of <code>tidyr</code>-verbs to reshape and reformat functional data while keeping it in sync with other covariates:</p>
<ul>
<li>
<code>tf_spread:</code> <code>tf</code> <span class="math inline">\(\rightarrow\)</span> columns for each <code>arg</code>
</li>
<li>
<code>tf_gather:</code> columns for each <code>arg</code> <span class="math inline">\(\rightarrow\)</span> <code>tf</code>
</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># spread tf out into columns for each arg</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">dti_wide =<span class="st"> </span>dti_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/tf_spread.html">tf_spread</a></span>(cca, <span class="dt">arg =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">93</span>))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">dti_wide[, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()  </a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">## Observations: 382</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">## Variables: 7</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">## $ id                     &lt;dbl&gt; 1001, 1002, 1003, 1004, 1005, 1006, 1007,…</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">## $ sex                    &lt;fct&gt; female, female, male, male, male, male, m…</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">## $ case                   &lt;fct&gt; control, control, control, control, contr…</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">## $ rcst                   &lt;tfd_irrg&gt; 1001_1: (0.000,0.26);(0.019,0.45);(0…</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">## $ cca_0                  &lt;dbl&gt; 0.4909345, 0.4721627, 0.5023738, 0.402189…</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">## $ cca_0.0108695652173913 &lt;dbl&gt; 0.5168018, 0.4868219, 0.5136516, 0.422512…</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">## $ cca_0.0217391304347826 &lt;dbl&gt; 0.5356539, 0.5022577, 0.5392542, 0.439898…</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co"># collect all columns into a single tf-column </span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co"># (... will try to guess arg from column names, name of tf from their prefix)</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">dti_wide <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/tf_gather.html">tf_gather</a></span>(<span class="kw">matches</span>(<span class="st">"cca_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">## creating new tfd-column &lt;cca&gt;</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">## Observations: 382</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">## Variables: 5</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">## $ id   &lt;dbl&gt; 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010,…</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">## $ sex  &lt;fct&gt; female, female, male, male, male, male, male, male, male, m…</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">## $ case &lt;fct&gt; control, control, control, control, control, control, contr…</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">## $ rcst &lt;tfd_irrg&gt; 1001_1: (0.000,0.26);(0.019,0.45);(0.037,0.40); ..., 1…</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">## $ cca  &lt;tfd_reg&gt; [1]: (0.000,0.49);(0.011,0.52);(0.022,0.54); ..., [2]: …</span></a></code></pre></div>
<ul>
<li>
<code>tf_unnest:</code> <code>tf</code> <span class="math inline">\(\rightarrow\)</span> data in long format (<code>id</code>, <code>arg</code>, <code>value</code>)<br>
</li>
<li>
<code>tf_nest  :</code> data in long format (<code>id</code>, <code>arg</code>, <code>value</code>) <span class="math inline">\(\rightarrow\)</span> <code>tf</code>
</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># unnest tf by writing 3 loong columns id, arg, value:</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># (will try to avoid unnecessary duplication of columns)</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">dti_long =<span class="st"> </span>dti_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/tf_unnest.html">tf_unnest</a></span>(cca); dti_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()  </a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">## Observations: 35,490</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">## Variables: 7</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">## $ id        &lt;dbl&gt; 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, …</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">## $ sex       &lt;fct&gt; female, female, female, female, female, female, female…</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">## $ case      &lt;fct&gt; control, control, control, control, control, control, …</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">## $ rcst      &lt;tfd_irrg&gt; 1001_1: (0.000,0.26);(0.019,0.45);(0.037,0.40); .…</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">## $ cca_id    &lt;chr&gt; "1001_1", "1001_1", "1001_1", "1001_1", "1001_1", "100…</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">## $ cca_arg   &lt;dbl&gt; 0.00000000, 0.01086957, 0.02173913, 0.03260870, 0.0434…</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">## $ cca_value &lt;dbl&gt; 0.4909345, 0.5168018, 0.5356539, 0.5553587, 0.5927610,…</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co"># nest tf by writing 3 loong columns id, arg, value:</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">dti_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/tf_nest.html">tf_nest</a></span>(cca_value, <span class="dt">.id =</span> cca_id, <span class="dt">.arg =</span> cca_arg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">## Observations: 382</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">## Variables: 6</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">## $ cca_id    &lt;chr&gt; "1001_1", "1002_1", "1003_1", "1004_1", "1005_1", "100…</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">## $ id        &lt;dbl&gt; 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, …</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">## $ sex       &lt;fct&gt; female, female, male, male, male, male, male, male, ma…</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">## $ case      &lt;fct&gt; control, control, control, control, control, control, …</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">## $ rcst      &lt;tfd_irrg&gt; 1001_1: (0.000,0.26);(0.019,0.45);(0.037,0.40); .…</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">## $ cca_value &lt;tfd_irrg&gt; 1001_1: (0.000,0.49);(0.011,0.52);(0.022,0.54); .…</span></a></code></pre></div>
<p>Note that <code>left/right_join</code>-operations as well as <code>bind_rows</code> do not currently work reliably for tables with <code>tfd</code> or <code>tfb</code>-columns, see <a href="https://github.com/fabian-s/tidyfun/issues/53">tidyfun/issues/53</a>. <code>bind_rows</code> can be easily avoided by using <code>rbind</code>, which still works, instead.</p>
</div>
<div id="convert-construct" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-construct" class="anchor"></a>convert &amp; construct</h3>
<p>To &amp; from list, matrix or data frame with <code>"id"</code>,<code>"arg"</code>,<code>"value"</code>-columns:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">ex_matrix &lt;-<span class="st"> </span>ex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>()</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">ex_matrix[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">ex_df &lt;-<span class="st"> </span>ex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>()</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(ex_df)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">ex_matrix[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/tfd.html">tfd</a></span>()</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw"><a href="../reference/tfd.html">tfd</a></span>(ex_df) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="../reference/tfd.html">tfd</a></span>(ex_matrix)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#conversion-from-matrices">Conversion from matrices</a></li>
      <li><a href="#from-data-frame">From data frame</a></li>
      <li><a href="#other-formats">Other formats</a></li>
      <li><a href="#back-to-matrices">Back to matrices</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Fabian Scheipl, Jeff Goldsmith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
